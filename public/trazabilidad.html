<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>La Historia de tu Producto - Ruru Lab</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Playfair+Display:wght@700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" xintegrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #fdfaf6; }
        h1, h2, h3, h4, .font-display { font-family: 'Playfair Display', serif; }
        dialog::backdrop { background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(3px); }
        
        /* Asegura que la navegación siempre esté por encima de todo */
        nav { z-index: 1001 !important; }

        .timeline-container { position: relative; max-width: 1000px; margin: 0 auto; }
        .timeline-container::after {
            content: ''; position: absolute; width: 4px; background-color: #d6d3d1;
            top: 0; bottom: 0; left: 50%; margin-left: -2px;
        }
        #timeline-progress {
            position: absolute; width: 4px; background-color: #854d0e;
            top: 0; left: 50%; margin-left: -2px; z-index: 0;
            height: 0; transition: height 0.1s linear;
        }
        .timeline-item { padding: 10px 40px; position: relative; background-color: inherit; width: 50%; }
        .timeline-item.left { left: 0; }
        .timeline-item.right { left: 50%; }
        .timeline-item::after {
            content: ''; position: absolute; width: 24px; height: 24px;
            right: -14px; background-color: #854d0e; border: 4px solid #fdfaf6;
            top: 25px; border-radius: 50%; z-index: 1;
        }
        .timeline-item.right::after { left: -14px; }
        .timeline-content { padding: 20px 30px; background-color: white; position: relative; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); }

        @media screen and (max-width: 768px) {
            .timeline-container::after, #timeline-progress { left: 18px; }
            .timeline-item { width: 100%; padding-left: 60px; padding-right: 15px; }
            .timeline-item.left, .timeline-item.right { left: 0%; }
            .timeline-item.left::after, .timeline-item.right::after { left: 6px; }
        }
    </style>
</head>
<body class="text-stone-800 antialiased">
    <nav class="bg-amber-900 text-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4">
             <div class="flex justify-between items-center h-16">
                <a href="/" class="text-xl font-bold"><i class="fa-solid fa-fingerprint mr-2"></i> Ruru Lab</a>
            </div>
        </div>
    </nav>
    <div class="container mx-auto p-4 md:p-8 max-w-4xl">
        <header class="text-center mb-16 mt-8">
            <div class="flex justify-center items-center mb-6">
                <svg id="footprint" class="w-64 h-64 text-white" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><path opacity=".4" d="M136.2 416.9C132.8 432.5 144.1 448 160.1 448C170.6 448 180 441 182.3 430.7C188.7 402.6 192 373.9 192 344.9L192 320C192 292.8 200.5 267.6 214.9 246.9C222.1 236.5 222.9 222.3 214.7 212.7C205.6 202.1 189.4 201.3 180.8 212.3C157.7 242.1 144 279.4 144 320L144 344.9C144 369.1 141.4 393.3 136.2 416.8zM257.2 188.5C264.3 196.8 276 199.3 286.6 196.4C297.2 193.5 308.4 192 320 192C390.7 192 448 249.3 448 320L448 344.9C448 370.1 446.5 395.2 443.6 420.2C441.9 434.8 453 448 467.8 448C479.6 448 489.7 439.4 491.1 427.7C494.4 400.3 496.1 372.7 496.1 345L496.1 320.1C496.1 222.9 417.3 144.1 320.1 144.1C301.1 144.1 282.7 147.1 265.6 152.7C250.4 157.7 246.9 176.4 257.3 188.6zM257.6 535.4C252.8 547.8 259 561.7 271.4 566.4C283.8 571.1 297.7 565 302.4 552.6L308.3 537.3C331.9 475.9 344 410.7 344 344.9L344 320C344 306.7 333.3 296 320 296C306.7 296 296 306.7 296 320L296 344.9C296 404.8 285 464.2 263.5 520.1L257.6 535.4z"/><path d="M112 320C112 205.1 205.1 112 320 112C383.1 112 439.6 140.1 477.8 184.5C486.4 194.6 501.6 195.7 511.6 187.1C521.6 178.5 522.8 163.3 514.2 153.3C467.3 98.6 397.7 64 320 64C178.6 64 64 178.6 64 320L64 360C64 373.3 74.7 384 88 384C101.3 384 112 373.3 112 360L112 320zM570.5 267.1C567.8 254.1 555 245.8 542.1 248.6C529.2 251.4 520.8 264.1 523.6 277C526.5 290.9 528.1 305.3 528.1 320.1L528.1 360.1C528.1 373.4 538.8 384.1 552.1 384.1C565.4 384.1 576.1 373.4 576.1 360.1L576.1 320.1C576.1 302 574.2 284.3 570.6 267.2zM416 320C416 267 373 224 320 224C267 224 224 267 224 320L224 344.9C224 380.8 219.4 416.4 210.2 451C206.4 465.3 216.9 480 231.7 480C241.2 480 249.6 473.8 252.1 464.6C262.6 425.6 268 385.4 268 344.9L268 320C268 291.3 291.3 268 320 268C348.7 268 372 291.3 372 320L372 344.9C372 381.2 368.5 417.3 361.6 452.8C358.9 466.7 369.3 480 383.4 480C393.6 480 402.4 473 404.4 463C412.1 424.2 416 384.7 416 344.9L416 320z"/></svg>
            </div>
            <h1 class="text-4xl md:text-5xl font-bold font-display text-amber-900 mb-4">El ADN de tu Producto</h1>
            <p class="text-stone-600 max-w-2xl mx-auto">Cada producto tiene una historia. El tuyo tiene una identidad. Estás a punto de descubrir el viaje único que dio vida al producto que tienes en tus manos. Esta es su historia.</p>
        </header>

        <div class="bg-white p-6 rounded-2xl shadow-lg mb-16">
            <div class="flex flex-col sm:flex-row gap-4">
                <input type="text" id="loteIdInput" placeholder="Ingresa el código del lote aquí..." class="w-full p-3 border border-stone-300 rounded-xl shadow-sm focus:ring-2 focus:ring-amber-800 transition">
                <button id="buscarBtn" class="bg-amber-800 hover:bg-amber-900 text-white font-bold py-3 px-8 rounded-xl shadow-md flex-shrink-0">Decodificar</button>
            </div>
        </div>
    </div>
    
    <div id="pre-timeline-container"></div>
    <main id="resultado-container" class="pb-16">
        <!-- El contenido dinámico se insertará aquí -->
    </main>

    <dialog id="image-modal" class="p-2 sm:p-4 bg-transparent border-0 rounded-2xl max-w-4xl w-full">
        <div class="bg-white p-4 rounded-xl relative">
            <h3 id="modal-title" class="text-lg font-bold font-display text-amber-900 mb-2"></h3>
            <button id="close-modal-btn" class="absolute top-2 right-2 bg-white rounded-full p-1 text-stone-600 hover:text-stone-900 focus:outline-none focus:ring-2 focus:ring-amber-800 z-10">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
            </button>
            <img id="modal-image" src="" alt="Foto del proceso" class="w-full h-auto object-contain max-h-[80vh] rounded-lg">
        </div>
    </dialog>
    <script src="/trazabilidad-publica.js"></script>
</body>
</html>
